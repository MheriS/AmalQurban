{
    "sourceFile": "app/Http/Controllers/KuponUmumController.php",
    "activeCommit": 0,
    "commits": [
        {
            "activePatchIndex": 3,
            "patches": [
                {
                    "date": 1748614015548,
                    "content": "Index: \n===================================================================\n--- \n+++ \n"
                },
                {
                    "date": 1748614561278,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1,16 +1,126 @@\n <?php\n \n namespace App\\Http\\Controllers;\n \n+use App\\Models\\Kuponumum;\n use Illuminate\\Http\\Request;\n-use App\\Models\\kuponumum;\n+use Illuminate\\Support\\Str;\n \n-class KuponUmumController extends Controller\n+class KuponumumController extends Controller\n {\n+    /**\n+     * Display a listing of the resource.\n+     */\n     public function index()\n     {\n-        $data = KuponUmum::all(); // Atau sesuaikan query Anda\n-        return view('kupon-umum.semua', compact('data'));\n+        $kuponumums = Kuponumum::paginate(10); //nyambung ke model\n+        // dd($kupons); // <--- debug: tampilkan isi data\n+        // dd(Kuponumum::first());\n+        return view('kuponumum.kuponumum', compact('kuponumums'));\n     }\n \n-}\n+    /**\n+     * Show the form for creating a new resource.\n+     */\n+    public function create()\n+    {\n+        return view('kuponumum.create');\n+    }\n+\n+    /**\n+     * Store a newly created resource in storage.\n+     */\n+    public function store(Request $request)\n+    {\n+        $request->validate([\n+            'wilayah' => 'required',\n+            'jatah' => 'required',\n+            'jenis_daging' => 'required',\n+            'jumlah_kupon' => 'required|integer|min:1',\n+        ]);\n+\n+        function generateNoKupon($length = 12) {\n+            $characters = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789';\n+            $kupon = '';\n+            for ($i = 0; $i < $length; $i++) {\n+                $kupon .= $characters[rand(0, strlen($characters) - 1)];\n+            }\n+            return $kupon;\n+        }\n+\n+        for ($i = 0; $i < $request->jumlah_kupon; $i++) {\n+            // Pastikan no_kupon unik\n+            do {\n+                $no_kupon = generateNoKupon();\n+            } while (Kuponumum::where('no_kupon', $no_kupon)->exists());\n+\n+            Kuponumum::create([\n+                'no_kupon' => $no_kupon,\n+                'wilayah' => $request->wilayah,\n+                'jatah' => $request->jatah,\n+                'jenis_daging' => $request->jenis_daging,\n+                'status' => 'Belum Scan',\n+            ]);\n+        }\n+\n+        return redirect()->route('kuponumum.index')->with('success', $request->jumlah_kupon . ' kupon berhasil ditambahkan');\n+    }\n+\n+    /**\n+     * Display the specified resource.\n+     */\n+    public function show(Kuponumum $kuponumum)\n+    {\n+        return view('kuponumum.show', compact('kuponumum'));\n+    }\n+\n+    /**\n+     * Show the form for editing the specified resource.\n+     */\n+    public function edit(Kuponumum $kuponumum)\n+    {\n+        return view('kuponumum.edit', compact('kuponumum'));\n+    }\n+\n+    /**\n+     * Update the specified resource in storage.\n+     */\n+    public function update(Request $request, Kuponumum $kuponumum)\n+    {\n+        $request->validate([\n+            // 'no_kupon' tidak divalidasi karena tidak bisa diubah\n+            'wilayah' => 'required',\n+            'jatah' => 'required',\n+            'jenis_daging' => 'required',\n+        ]);\n+\n+        // Ambil hanya field yang boleh diupdate\n+        $data = $request->only(['wilayah', 'jatah', 'jenis_daging']);\n+\n+        $kuponumum->update($data);\n+\n+        return redirect()->route('kuponumum.index')->with('success', 'Kupon berhasil diupdate');\n+    }\n+\n+    /**\n+     * Remove the specified resource from storage.\n+     */\n+    public function destroy(Kuponumum $kuponumum)\n+    {\n+        $kuponumum->delete();\n+        return redirect()->route('kuponumum.index')->with('success', 'Kupon berhasil dihapus');\n+    }\n+\n+    public function belumScan()\n+    {\n+        $kuponumums = Kuponumum::where('status', 'Belum Scan')->paginate(10);\n+        return view('kuponumum.kuponumum', compact('kuponumums'));\n+    }\n+\n+    public function sudahScan()\n+    {\n+        $kuponumums = Kuponumum::where('status', 'Sudah Scan')->paginate(10);\n+        return view('kuponumum.kuponumum', compact('kuponumums'));\n+    }\n+\n+}\n\\ No newline at end of file\n"
                },
                {
                    "date": 1748645603630,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -91,8 +91,9 @@\n             // 'no_kupon' tidak divalidasi karena tidak bisa diubah\n             'wilayah' => 'required',\n             'jatah' => 'required',\n             'jenis_daging' => 'required',\n+            'status' => 'required',\n         ]);\n \n         // Ambil hanya field yang boleh diupdate\n         $data = $request->only(['wilayah', 'jatah', 'jenis_daging']);\n"
                },
                {
                    "date": 1748645620597,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -95,9 +95,9 @@\n             'status' => 'required',\n         ]);\n \n         // Ambil hanya field yang boleh diupdate\n-        $data = $request->only(['wilayah', 'jatah', 'jenis_daging']);\n+        $data = $request->only(['wilayah', 'jatah', 'jenis_daging', 'status']);\n \n         $kuponumum->update($data);\n \n         return redirect()->route('kuponumum.index')->with('success', 'Kupon berhasil diupdate');\n"
                }
            ],
            "date": 1748614015548,
            "name": "Commit-0",
            "content": "<?php\n\nnamespace App\\Http\\Controllers;\n\nuse Illuminate\\Http\\Request;\nuse App\\Models\\kuponumum;\n\nclass KuponUmumController extends Controller\n{\n    public function index()\n    {\n        $data = KuponUmum::all(); // Atau sesuaikan query Anda\n        return view('kupon-umum.semua', compact('data'));\n    }\n\n}\n"
        }
    ]
}